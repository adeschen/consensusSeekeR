<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract regions sharing features in more than one experiment — findConsensusPeakRegions • consensusSeekeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract regions sharing features in more than one experiment — findConsensusPeakRegions"><meta property="og:description" content="Find regions sharing the same features for a minimum number of
experiments using called peaks of signal enrichment based on
pooled, normalized data (mainly coming from narrowPeak files).
The peaks and narrow peaks are used to identify
the consensus regions. The minimum number of experiments that must
have at least on peak in a region so that it is retained as a
consensus region is specified by user, as well as the size of
mining regions. Only the chromosomes specified by the user are treated.
The function can be parallized by specifying a number of threads superior
to 1.
When the padding is small, the detected regions are smaller than
the one that could be obtained by doing an overlap of the narrow
regions. Even more, the parameter specifying the minimum number of
experiments needed to retain a region add versatility to the
function.
Beware that the side of the padding can have a large effect on
the detected consensus
regions. It is recommanded to test more than one size and to do
some manual validation of the resulting consensus regions before
selecting the final padding size."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">consensusSeekeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.31.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/consensusSeekeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeschen/consensusSeekeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract regions sharing features in more than one experiment</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeschen/consensusSeekeR/blob/HEAD/R/findConsensusPeakRegions.R" class="external-link"><code>R/findConsensusPeakRegions.R</code></a></small>
    <div class="hidden name"><code>findConsensusPeakRegions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find regions sharing the same features for a minimum number of
experiments using called peaks of signal enrichment based on
pooled, normalized data (mainly coming from narrowPeak files).
The peaks and narrow peaks are used to identify
the consensus regions. The minimum number of experiments that must
have at least on peak in a region so that it is retained as a
consensus region is specified by user, as well as the size of
mining regions. Only the chromosomes specified by the user are treated.
The function can be parallized by specifying a number of threads superior
to 1.</p>
<p>When the padding is small, the detected regions are smaller than
the one that could be obtained by doing an overlap of the narrow
regions. Even more, the parameter specifying the minimum number of
experiments needed to retain a region add versatility to the
function.</p>
<p>Beware that the side of the padding can have a large effect on
the detected consensus
regions. It is recommanded to test more than one size and to do
some manual validation of the resulting consensus regions before
selecting the final padding size.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findConsensusPeakRegions</span><span class="op">(</span></span>
<span>  <span class="va">narrowPeaks</span>,</span>
<span>  <span class="va">peaks</span>,</span>
<span>  <span class="va">chrInfo</span>,</span>
<span>  extendingSize <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  expandToFitPeakRegion <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shrinkToFitPeakRegion <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  minNbrExp <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  nbrThreads <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>narrowPeaks</dt>
<dd><p>a <code>GRanges</code> containing
called peak regions of signal enrichment based on pooled, normalized data
for all analyzed experiments. All <code>GRanges</code> entries must
have a metadata field called "name" which identifies the region to
the called peak. All <code>GRanges</code> entries must also
have a row name which identifies the experiment of origin. Each
<code>peaks</code> entry must have an associated <code>narrowPeaks</code> entry.
A <code>GRanges</code> entry is associated to a <code>narrowPeaks</code> entry by
having a identical metadata "name" field and a identical row name.</p></dd>


<dt>peaks</dt>
<dd><p>a <code>GRanges</code> containing called peaks of signal
enrichment based on pooled, normalized data
for all analyzed experiments. All <code>GRanges</code> entries must
have a metadata field called "name" which identifies the called
peak. All <code>GRanges</code> entries must
have a row name which identifies the experiment of origin. Each
<code>peaks</code> entry must have an associated <code>narrowPeaks</code> entry. A
<code>GRanges</code> entry is associated to a <code>narrowPeaks</code> entry by having
a identical metadata "name" field and a identical row name.</p></dd>


<dt>chrInfo</dt>
<dd><p>a <code>Seqinfo</code> containing the name and the length of the
chromosomes to analyze. Only the chomosomes contained in this
<code>Seqinfo</code> will be analyzed.</p></dd>


<dt>extendingSize</dt>
<dd><p>a <code>numeric</code> value indicating the size of padding
on both sides of the position of the peaks median to create the
consensus region. The minimum size of the consensus region is
equal to twice the value of the <code>extendingSize</code> parameter.
The size of the <code>extendingSize</code> must be a positive integer.
Default = 250.</p></dd>


<dt>expandToFitPeakRegion</dt>
<dd><p>a <code>logical</code> indicating if the region size,
which is set by the <code>extendingSize</code> parameter is extended to include
the entire narrow peak regions of all peaks included in the unextended
consensus region. The narrow peak regions of the peaks added because of the
extension are not considered for the extension. Default: <code>FALSE</code>.</p></dd>


<dt>shrinkToFitPeakRegion</dt>
<dd><p>a <code>logical</code> indicating if the region size,
which is set by the <code>extendingSize</code> parameter is shrinked to
fit the narrow peak regions of the peaks when all those regions
are smaller than the consensus region. Default: <code>FALSE</code>.</p></dd>


<dt>minNbrExp</dt>
<dd><p>a positive <code>numeric</code> or a positive <code>integer</code>
indicating the minimum number of experiments in which at least one peak
must be present for a potential consensus region. The numeric must be a
positive integer inferior or equal to the number of experiments present
in the <code>narrowPeaks</code> and <code>peaks</code> parameters. Default = 1.</p></dd>


<dt>nbrThreads</dt>
<dd><p>a <code>numeric</code> or a <code>integer</code> indicating the
number of threads to use in parallel. The <code>nbrThreads</code> must be a
positive integer. Default = 1.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>an <code>list</code> of <code>class</code> "consensusRanges" containing :</p><ul><li><p><code>call</code> the matched call.</p></li>
<li><p><code>consensusRanges</code> a <code>GRanges</code> containing the
consensus regions.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Astrid Deschênes</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Loading datasets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">A549_CTCF_MYN_NarrowPeaks_partial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">A549_CTCF_MYN_Peaks_partial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_NarrowPeaks_partial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_Peaks_partial</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Assigning experiment name "CTCF_MYJ" to first experiment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_NarrowPeaks_partial</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CTCF_MYJ"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_NarrowPeaks_partial</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_Peaks_partial</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CTCF_MYJ"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_Peaks_partial</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Assigning experiment name "CTCF_MYN" to second experiment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">A549_CTCF_MYN_NarrowPeaks_partial</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CTCF_MYN"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A549_CTCF_MYN_NarrowPeaks_partial</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">A549_CTCF_MYN_Peaks_partial</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CTCF_MYN"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A549_CTCF_MYN_Peaks_partial</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Only choromsome 1 is going to be analysed</span></span></span>
<span class="r-in"><span><span class="va">chrList</span> <span class="op">&lt;-</span> <span class="fu">Seqinfo</span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fl">249250621</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Find consensus regions with both experiments</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">findConsensusPeakRegions</span><span class="op">(</span></span></span>
<span class="r-in"><span>    narrowPeaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_NarrowPeaks_partial</span>,</span></span>
<span class="r-in"><span>        <span class="va">A549_CTCF_MYN_NarrowPeaks_partial</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A549_CTCF_MYJ_Peaks_partial</span>,</span></span>
<span class="r-in"><span>        <span class="va">A549_CTCF_MYN_Peaks_partial</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chrInfo <span class="op">=</span> <span class="va">chrList</span>,</span></span>
<span class="r-in"><span>    extendingSize <span class="op">=</span> <span class="fl">300</span>,</span></span>
<span class="r-in"><span>    expandToFitPeakRegion <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    shrinkToFitPeakRegion <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    minNbrExp <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    nbrThreads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Print 2 first consensus regions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">consensusRanges</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 2 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames              ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1 246022229-246022829      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1 246051998-246052598      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Astrid Deschênes, Pascal Belleau, Arnaud Droit.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

